# Come creare un progetto ASP.NET Core
1. File > New > Project > ASP.NET Core Web Application
2. Scegliere il template "Empty" e quindi "No Authentication"; non selezionare "Enable Docker Support".
3. Come nome indicare "Health.Web"

Note: Provare a lanciare con IIS Express o direttamente, cambiare browser, avviare in debug mode o meno.

# MVC setup
1. Tasto destro sulla solution > Manage NuGet Packages for Solution
2. Cercare e referenziare "Microsoft.AspNetCore.Mvc"
3. Creare nel progetto il folder Controllers
4. Tasto destro su Controllers > Add > Controller... > MVC Controller Empty; dare il nome "HomeController" al controller appena creato
5. Codice del controller:

```csharp
using Microsoft.AspNetCore.Mvc;

namespace Health.Web.Controllers
{
    public class HomeController : Controller
    {
        public IActionResult Index() => Content("Hello MVC!");
    }
}
```

6. Modificare la classe Startup.cs come segue:

```csharp
using Microsoft.AspNetCore.Builder;
using Microsoft.AspNetCore.Hosting;
using Microsoft.AspNetCore.Http;
using Microsoft.Extensions.DependencyInjection;

namespace Health.Web
{
    public class Startup
    {
        public void ConfigureServices(IServiceCollection services)
        {
            services.AddMvc();
        }

        public void Configure(IApplicationBuilder app, IHostingEnvironment env)
        {
            if (env.IsDevelopment())
            {
                app.UseDeveloperExceptionPage();
            }

            app.UseStaticFiles();

            /*
             Shortcut per:

             routes.MapRoute(
                name: "default",
                template: "{controller=Home}/{action=Index}/{id?}");
             */
            app.UseMvcWithDefaultRoute();

            app.Run(async (context) =>
            {
                await context.Response.WriteAsync("Oops, something went wrong");
            });
        }
    }
}
```

7. Provare ora a modificare HomeController nel seguente modo:

```csharp
using Microsoft.AspNetCore.Mvc;
using System;

namespace Health.Web.Controllers
{
    public class HomeController : Controller
    {
        public IActionResult Index() => throw new DivideByZeroException("This exception is generated by controller");
    }
}
```

# View
1. Aggiungere al progetto il folder Views
2. Aggiungere il folder Home come subfolder di Views
3. Modificare HomeController come segue:

```csharp
using Microsoft.AspNetCore.Mvc;

namespace Health.Web.Controllers
{
    public class HomeController : Controller
    {
        public IActionResult Index()
        {
            ViewBag.Title = "Hello Razor";

            return View();
        }
    }
}
```

4. Tasto destro su Home > Add > View...:

>* *View name*: Index
>* *Template*: Empty (without model)
>* *Create as a partial view*: non selezionato
>* *Use a layout page*: lasciare selezionato

5. Modificare il file Index.cshtml come segue:

```csharp
<!DOCTYPE html>
<html>
<head>
    <title>@ViewBag.Title</title>
</head>
<body>
    <h1>Hello Razor!</h1>
</body>
</html>
```

# Layout
1. Creare il folder Shared all'interno di Views
2. Click con il tasto destro su Shared > Add > New Item...
3. Filtrare per "layout" e scegliere quindi "Razor Layout" lasciando il nome di default _Layout.cshtml
4. Modificare il file HomeController come segue:

```csharp
using Microsoft.AspNetCore.Mvc;

namespace Health.Web.Controllers
{
    public class HomeController : Controller
    {
        public IActionResult Index() => View();
    }
}
```

5. Modificare il file Views/Home/Index.cshtml come segue:

```csharp
@{ 
    ViewBag.Title = "Hello Razor";
}

<h1>Hello Razor!</h1>
```

6. Tasto destro sul folder Views > Add > New Item...; filtrare per "razor" e sceglier "Razor View Start"
7. Lanciare e osservare il risultato.

# Model
1. Aggiungere il folder Models a pari livello di Controllers e Views
2. Aggiungere nel folder Models il file Person.cs 

```csharp
namespace Health.Web.Models
{
    public class Person
    {
        public int Id { get; set; }

        public string FirstName { get; set; }

        public string LastName { get; set; }
    }
}
```

3. Tasto destro su Views > Add > New Item...; filtrare per "razor" e scegliere "Razor View Imports"; nel file così creato aggiungere:

```csharp
@using Health.Web.Models
```

4. Modificare HomeController.cs come segue:

```csharp
using Health.Web.Models;
using Microsoft.AspNetCore.Mvc;

namespace Health.Web.Controllers
{
    public class HomeController : Controller
    {
        public IActionResult Index()
        {
            var model = new[]
            {
                new Person { Id = 1, FirstName = "John", LastName = "Smith" },
                new Person { Id = 2, FirstName = "Jim", LastName = "Gordon" },
            };

            return View(model);
        }
    }
}
```

5. Modificare il file Home/Index.cshtml

```csharp
@model IEnumerable<Person>
@{ 
    ViewBag.Title = "Hello Razor";
}

<table border="1">
    @foreach (var p in Model)
    {
    <tr>
        <td>@p.Id</td>    
        <td>@p.FirstName</td>
        <td>@p.LastName</td>
    </tr>
    }
</table>
```

# Kendo UI
1. Creare il folder kendo all'interno di wwwroot
2. Copiare i folder js e styles dalla directory di Kendo al folder wwwroot/kendo del progetto
3. Modificare il file Views/Shared/_Layout.cshtml come segue:

```csharp
<!DOCTYPE html>
<html>
<head>
    <title>@ViewBag.Title</title>

    <link href="//fonts.googleapis.com/css?family=Open+Sans:400,300,600,700&subset=all" rel="stylesheet" type="text/css" />

    <link href="~/kendo/styles/kendo.common.min.css" rel="stylesheet" />
    <link href="~/kendo/styles/kendo.material.min.css" rel="stylesheet" />

    <script src="~/kendo/js/jquery.min.js"></script>
    <script src="~/kendo/js/kendo.all.min.js"></script>

    <style>

        html, body {
            font-family: 'Open Sans', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

    </style>
</head>
<body>
    @RenderBody()
</body>
</html>
```

4. Modificare il file Views/Home/Index.cshtml come segue:

```csharp
@model IEnumerable<Person>
@{ 
    ViewBag.Title = "Hello Razor";
}

<div id="grid"></div>

<script>

    $(document).ready(function () {
        var data = @(Json.Serialize(Model));

        $("#grid").kendoGrid({
            dataSource: {
                data: data,
                schema: {
                    model: {
                        fields: {
                            id: { type: "number" },
                            firstName: { type: "string" },
                            lastName: { type: "string" }
                        }
                    }
                }
            },
            scrollable: true,
            sortable: true,
            filterable: true,
            editable: false,
            columns: [
                "id",
                { field: "firstName", title: "First Name" },
                { field: "lastName", title: "Last Name" }
            ]
        });
    })

</script>
```

# Riferimenti
* ASP.NET: https://docs.microsoft.com/en-us/aspnet/core/?view=aspnetcore-2.0
* Creazione di servizi REST: https://docs.microsoft.com/en-us/aspnet/core/tutorials/first-web-api?view=aspnetcore-2.0
* Autenticazione: https://docs.microsoft.com/en-us/aspnet/core/security/authentication/?view=aspnetcore-2.0
* Razor syntax reference: https://docs.microsoft.com/en-us/aspnet/core/mvc/views/razor?view=aspnetcore-2.0
* Kendo UI book: http://codylindley.github.io/the-kendo-ui-book/
* Template UI: https://adminlte.io/
